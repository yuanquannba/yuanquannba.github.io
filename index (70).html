<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å…œå…œè‹±è¯­èƒŒå•è¯</title>
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <!-- å¼•å…¥ SheetJS åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- å¼•å…¥ LeanCloud SDK -->
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.0/dist/av-min.js"></script>
    <script>
        // åˆå§‹åŒ– LeanCloud
        const APP_ID = 'QWYwfiGZ7tWJsZZwSD8bzylJ-gzGzoHsz';
        const APP_KEY = 'ZZYZoKb2kjqNvL5ag9SLWwd1';
        const SERVER_URL = 'https://qwywfigz.lc-cn-n1-shared.com';

        AV.init({
            appId: APP_ID,
            appKey: APP_KEY,
            serverURL: SERVER_URL
        });

        // æ›¿æ¢åŸæœ‰çš„æ•°æ®å£°æ˜
        let words = [];
        let statistics = {};
        let quizResults = [];

        // æ–°å¢äº‘ç«¯æ•°æ®åŒæ­¥æ–¹æ³•
        async function syncCloudData() {
            try {
                const cloudData = await new AV.Query('AppData').first();
                if (cloudData) {
                    words = cloudData.get('words') || [];
                    statistics = cloudData.get('statistics') || {};
                    quizResults = cloudData.get('quizResults') || [];
                    console.log('ä»äº‘ç«¯åŠ è½½æ•°æ®æˆåŠŸ');
                }
            } catch (error) {
                console.error('äº‘ç«¯æ•°æ®åŠ è½½å¤±è´¥:', error);
            }
        }

        // æ›¿æ¢åŸæœ‰çš„ saveData å‡½æ•°
        async function saveData() {
            try {
                let cloudData = await new AV.Query('AppData').first();
                if (!cloudData) {
                    cloudData = new AV.Object('AppData');
                }
                cloudData.set('words', words);
                cloudData.set('statistics', statistics);
                cloudData.set('quizResults', quizResults);
                await cloudData.save();
                console.log('æ•°æ®å·²ä¿å­˜åˆ°äº‘ç«¯');
                // ä¿å­˜æˆåŠŸåé‡æ–°åŒæ­¥æ•°æ®å¹¶æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
                await syncCloudData();
                updateStatistics();
            } catch (error) {
                console.error('äº‘ç«¯ä¿å­˜å¤±è´¥:', error);
                alert('æ•°æ®ä¿å­˜åˆ°äº‘ç«¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨åé‡è¯•ã€‚');
            }
        }

        const LEVELS = {
            RED: 'ğŸ”´ çº¢åŒºï¼ˆé«˜é¢‘é”™è¯¯è¯ï¼‰',
            YELLOW: 'ğŸŸ¡ é»„åŒºï¼ˆé—´æ­‡é”™è¯¯è¯ï¼‰',
            GREEN_NEW: 'ğŸŸ¢ ç»¿åŒºï¼ˆæ–°å­¦æœªæµ‹è¯ï¼‰',
            GREEN_TESTED: 'ğŸŸ¢ ç»¿åŒºï¼ˆå·²æµ‹éªŒè¯ï¼‰',
            BLUE: 'ğŸ”µ è“åŒºï¼ˆç¨³å®šæŒæ¡è¯ï¼‰'
        };

        function importWords() {
            const input = document.getElementById('word-input').value;
            const lines = input.split('\n');
            const newWords = [];
            const duplicateWords = [];

            for (let line of lines) {
                if (line) {
                    const [word, meaning] = line.split('-');
                    const isDuplicate = words.some(w => w.word === word.trim());
                    if (isDuplicate) {
                        duplicateWords.push(word);
                    } else {
                        newWords.push({ word: word.trim(), meaning: meaning.trim(), lastReviewed: null, level: LEVELS.GREEN_NEW, consecutiveCorrect: 0 });
                    }
                }
            }

            if (duplicateWords.length > 0) {
                const confirmMessage = `ä»¥ä¸‹è‹±è¯­å•è¯å·²å­˜åœ¨äºè¯åº“ä¸­ï¼š${duplicateWords.join(', ')}ã€‚æ˜¯å¦ä»è¦å¯¼å…¥è¿™äº›é‡å¤å•è¯ï¼Ÿ`;
                const shouldImport = confirm(confirmMessage);
                if (!shouldImport) {
                    document.getElementById('word-input').value = '';
                    return;
                }
            }

            newWords.forEach(newWord => {
                words.push(newWord);
                if (!statistics[newWord.word]) {
                    statistics[newWord.word] = {
                        total: 0,
                        correct: 0,
                        wrong: 0
                    };
                }
            });

            duplicateWords.forEach(duplicateWord => {
                const line = lines.find(l => l.startsWith(duplicateWord));
                const [word, meaning] = line.split('-');
                words.push({ word: word.trim(), meaning: meaning.trim(), lastReviewed: null, level: LEVELS.GREEN_NEW, consecutiveCorrect: 0 });
                if (!statistics[word.trim()]) {
                    statistics[word.trim()] = {
                        total: 0,
                        correct: 0,
                        wrong: 0
                    };
                }
            });

            updateStatistics();
            document.getElementById('word-input').value = '';
            saveData();
            console.log('å¯¼å…¥è‹±è¯­è¯åº“åï¼Œwords:', words);
            console.log('å¯¼å…¥è‹±è¯­è¯åº“åï¼Œstatistics:', statistics);
        }

        function updateStatistics() {
            const tableBody = document.getElementById('statistics-table-body');
            tableBody.innerHTML = '';
            const sortedWords = words.slice().sort((a, b) => {
                const statA = statistics[a.word];
                const statB = statistics[b.word];
                const errorRateA = statA.total > 0 ? statA.wrong / statA.total : 0;
                const errorRateB = statB.total > 0 ? statB.wrong / statB.total : 0;
                return errorRateB - errorRateA;
            });
            sortedWords.forEach(wordObj => {
                const { word, meaning, level } = wordObj;
                const stat = statistics[word];
                const errorRate = stat.total > 0 ? Math.round(stat.wrong / stat.total * 100) + '%' : '0%';
                const row = tableBody.insertRow();
                row.insertCell().textContent = word;
                row.insertCell().textContent = meaning;

                const totalCell = row.insertCell();
                const totalInput = document.createElement('input');
                totalInput.type = 'number';
                totalInput.value = stat.total;
                totalInput.addEventListener('change', function () {
                    const newTotal = parseInt(this.value);
                    if (!isNaN(newTotal) && newTotal >= 0) {
                        stat.total = newTotal;
                        if (stat.correct > newTotal) {
                            stat.correct = newTotal;
                        }
                        if (stat.wrong > newTotal) {
                            stat.wrong = newTotal - stat.correct;
                        }
                        updateStatistics();
                        saveData();
                    }
                });
                totalCell.appendChild(totalInput);

                const correctCell = row.insertCell();
                const correctInput = document.createElement('input');
                correctInput.type = 'number';
                correctInput.value = stat.correct;
                correctInput.addEventListener('change', function () {
                    const newCorrect = parseInt(this.value);
                    if (!isNaN(newCorrect) && newCorrect >= 0 && newCorrect <= stat.total) {
                        stat.correct = newCorrect;
                        stat.wrong = stat.total - newCorrect;
                        updateStatistics();
                        saveData();
                    }
                });
                correctCell.appendChild(correctInput);

                const wrongCell = row.insertCell();
                const wrongInput = document.createElement('input');
                wrongInput.type = 'number';
                wrongInput.value = stat.wrong;
                wrongInput.addEventListener('change', function () {
                    const newWrong = parseInt(this.value);
                    if (!isNaN(newWrong) && newWrong >= 0 && newWrong <= stat.total) {
                        stat.wrong = newWrong;
                        stat.correct = stat.total - newWrong;
                        updateStatistics();
                        saveData();
                    }
                });
                wrongCell.appendChild(wrongInput);

                row.insertCell().textContent = stat.total > 0 ? Math.round(stat.wrong / stat.total * 100) + '%' : '0%';
                const displayLevel = stat.total > 0 && level === LEVELS.GREEN_NEW ? LEVELS.GREEN_TESTED : level;
                row.insertCell().textContent = displayLevel;

                const actionCell = row.insertCell();
                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'åˆ é™¤';
                deleteButton.classList.add('bg-red-600', 'text-white', 'py-2', 'px-4', 'rounded-md', 'hover:bg-red-700', 'transition-colors', 'text-sm', 'shadow-md');
                deleteButton.addEventListener('click', function () {
                    const confirmDelete = confirm(`ç¡®å®šè¦åˆ é™¤è‹±è¯­å•è¯ ${word} çš„è®°å½•å—ï¼Ÿ`);
                    if (confirmDelete) {
                        words = words.filter(w => w.word!== word);
                        delete statistics[word];
                        updateStatistics();
                        saveData();
                    }
                });
                actionCell.appendChild(deleteButton);
            });
            console.log('æ›´æ–°è‹±è¯­ç»Ÿè®¡ä¿¡æ¯åï¼Œwords:', words);
            console.log('æ›´æ–°è‹±è¯­ç»Ÿè®¡ä¿¡æ¯åï¼Œstatistics:', statistics);
        }

        function randomQuiz() {
            const filterInput = document.getElementById('filter-input');
            filterInput.style.display = 'none';
            const selectionList = document.getElementById('selection-list');
            selectionList.style.display = 'none';

            const redWords = words.filter(word => word.level === LEVELS.RED).sort((a, b) => statistics[b.word].total - statistics[a.word].total);
            const yellowWords = words.filter(word => word.level === LEVELS.YELLOW).sort((a, b) => statistics[b.word].total - statistics[a.word].total);
            const greenWords = words.filter(word => [LEVELS.GREEN_NEW, LEVELS.GREEN_TESTED].includes(word.level)).sort(() => Math.random() - 0.5);
            const otherWords = words.filter(word => ![LEVELS.RED, LEVELS.YELLOW, LEVELS.GREEN_NEW, LEVELS.GREEN_TESTED].includes(word.level)).sort((a, b) => statistics[b.word].total - statistics[a.word].total);

            let quizWords = [];

            // é€‰å–çº¢åŒºå•è¯
            quizWords = quizWords.concat(redWords.slice(0, 5));
            if (quizWords.length < 5) {
                const remaining = 5 - quizWords.length;
                quizWords = quizWords.concat(yellowWords.slice(0, remaining));
                if (quizWords.length < 5) {
                    const stillRemaining = 5 - quizWords.length;
                    quizWords = quizWords.concat(greenWords.slice(0, stillRemaining));
                    if (quizWords.length < 5) {
                        const finalRemaining = 5 - quizWords.length;
                        quizWords = quizWords.concat(otherWords.slice(0, finalRemaining));
                    }
                }
            }

            // é€‰å–é»„åŒºå•è¯
            const currentLength = quizWords.length;
            quizWords = quizWords.concat(yellowWords.filter(word => !quizWords.includes(word)).slice(0, 3 - (currentLength - 5)));
            if (quizWords.length < currentLength + 3 - (currentLength - 5)) {
                const remaining = (currentLength + 3 - (currentLength - 5)) - quizWords.length;
                quizWords = quizWords.concat(greenWords.filter(word => !quizWords.includes(word)).slice(0, remaining));
                if (quizWords.length < currentLength + 3 - (currentLength - 5)) {
                    const stillRemaining = (currentLength + 3 - (currentLength - 5)) - quizWords.length;
                    quizWords = quizWords.concat(otherWords.filter(word => !quizWords.includes(word)).slice(0, stillRemaining));
                }
            }

            // é€‰å–ç»¿åŒºå•è¯
            const currentLengthAfterYellow = quizWords.length;
            quizWords = quizWords.concat(greenWords.filter(word => !quizWords.includes(word)).slice(0, 2 - (currentLengthAfterYellow - 8)));
            if (quizWords.length < currentLengthAfterYellow + 2 - (currentLengthAfterYellow - 8)) {
                const remaining = (currentLengthAfterYellow + 2 - (currentLengthAfterYellow - 8)) - quizWords.length;
                quizWords = quizWords.concat(otherWords.filter(word => !quizWords.includes(word)).slice(0, remaining));
            }

            showQuizWords(quizWords);
            lastQuizTime = Date.now();
        }

        function showSelectionList() {
            const quizWordsDiv = document.getElementById('quiz-words');
            quizWordsDiv.innerHTML = '';
            const filterInput = document.getElementById('filter-input');
            filterInput.style.display = 'none';
            const selectionList = document.getElementById('selection-list');
            selectionList.style.display = 'block';
            const tableBody = document.getElementById('selection-list-table-body');
            tableBody.innerHTML = '';
            const sortedWords = words.slice().sort((a, b) => {
                const statA = statistics[a.word];
                const statB = statistics[b.word];
                const errorRateA = statA.total > 0 ? statA.wrong / statA.total : 0;
                const errorRateB = statB.total > 0 ? statB.wrong / statB.total : 0;
                return errorRateB - errorRateA;
            });
            sortedWords.forEach((wordObj, index) => {
                const { word, meaning, level } = wordObj;
                const stat = statistics[word];
                const errorRate = stat.total > 0 ? Math.round(stat.wrong / stat.total * 100) + '%' : '0%';
                const row = tableBody.insertRow();
                const checkboxCell = row.insertCell();
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.dataset.word = JSON.stringify(wordObj);
                checkboxCell.appendChild(checkbox);
                row.insertCell().textContent = word;
                row.insertCell().textContent = meaning;
                row.insertCell().textContent = stat.total;
                row.insertCell().textContent = errorRate;
                const displayLevel = stat.total > 0 && level === LEVELS.GREEN_NEW ? LEVELS.GREEN_TESTED : level;
                row.insertCell().textContent = displayLevel;
            });
            const searchInput = document.getElementById('selection-search');
            searchInput.value = '';
            searchInput.addEventListener('input', function () {
                const searchTerm = this.value.toLowerCase();
                const rows = tableBody.querySelectorAll('tr');
                rows.forEach(row => {
                    const wordCell = row.cells[1];
                    const meaningCell = row.cells[2];
                    const word = wordCell.textContent.toLowerCase();
                    const meaning = meaningCell.textContent.toLowerCase();
                    if (word.includes(searchTerm) || meaning.includes(searchTerm)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
            console.log('è‹±è¯­è‡ªä¸»é€‰é¢˜åˆ—è¡¨å·²æ˜¾ç¤º');
        }

        function showQuizWords(quizWords) {
            const quizWordsDiv = document.getElementById('quiz-words');
            quizWordsDiv.innerHTML = '';
            quizWords.forEach(wordObj => {
                const { word, meaning } = wordObj;
                const wordRow = document.createElement('div');
                wordRow.classList.add('flex', 'flex-col', 'md:flex-row', 'items-center', 'mb-6', 'p-4', 'bg-gray-50', 'rounded-lg', 'shadow-md');
                const wordMeaning = document.createElement('div');
                wordMeaning.classList.add('flex-1', 'min-w-[200px]', 'text-xl', 'mb-4', 'md:mb-0', 'md:mr-6');
                wordMeaning.textContent = meaning;
                const showButton = document.createElement('button');
                showButton.textContent = 'æ˜¾ç¤ºè‹±æ–‡';
                showButton.classList.add('bg-blue-600', 'text-white', 'py-3', 'px-6', 'rounded-md', 'hover:bg-blue-700', 'transition-colors', 'mr-6', 'mb-4', 'md:mb-0', 'shadow-md');
                let isShowingEnglish = false;
                showButton.onclick = function () {
                    if (isShowingEnglish) {
                        wordMeaning.textContent = meaning;
                        showButton.textContent = 'æ˜¾ç¤ºè‹±æ–‡';
                    } else {
                        wordMeaning.textContent = word;
                        showButton.textContent = 'æ˜¾ç¤ºä¸­æ–‡';
                    }
                    isShowingEnglish = !isShowingEnglish;
                };
                const correctButton = document.createElement('button');
                correctButton.textContent = 'æ­£ç¡®';
                correctButton.classList.add('bg-green-600', 'text-white', 'py-3', 'px-6', 'rounded-md', 'hover:bg-green-700', 'transition-colors', 'mr-6', 'mb-4', 'md:mb-0', 'shadow-md');
                const wrongButton = document.createElement('button');
                wrongButton.textContent = 'é”™è¯¯';
                wrongButton.classList.add('bg-red-600', 'text-white', 'py-3', 'px-6', 'rounded-md', 'hover:bg-red-700', 'transition-colors', 'shadow-md');

                const handleAnswer = function (isCorrect, clickedButton) {
                    const wordIndex = words.findIndex(w => w.word === word);
                    if (isCorrect) {
                        statistics[word].correct++;
                        statistics[word].total++;
                        words[wordIndex].consecutiveCorrect++;
                        if (words[wordIndex].consecutiveCorrect >= 3) {
                            upgradeLevel(wordIndex);
                        }
                    } else {
                        statistics[word].wrong++;
                        statistics[word].total++;
                        words[wordIndex].consecutiveCorrect = 0;
                        downgradeLevel(wordIndex);
                    }
                    if (words[wordIndex].level === LEVELS.GREEN_NEW && statistics[word].total > 0) {
                        words[wordIndex].level = LEVELS.GREEN_TESTED;
                    }
                    updateStatistics();
                    saveData();
                    // ä»…å°†ç‚¹å‡»çš„æŒ‰é’®å˜ç°
                    clickedButton.disabled = true;
                    clickedButton.classList.remove(clickedButton.classList.contains('bg-green-600') ? 'bg-green-600' : 'bg-red-600');
                    clickedButton.classList.remove(clickedButton.classList.contains('hover:bg-green-700') ? 'hover:bg-green-700' : 'hover:bg-red-700');
                    clickedButton.classList.add('bg-gray-400', 'cursor-not-allowed');
                    // ç¦ç”¨å¦ä¸€ä¸ªæŒ‰é’®ä½†ä¸å˜é¢œè‰²
                    const otherButton = clickedButton === correctButton ? wrongButton : correctButton;
                    otherButton.disabled = true;

                    const currentDate = new Date().toLocaleDateString();
                    const existingResultIndex = quizResults.findIndex(result => result.date === currentDate);
                    if (existingResultIndex !== -1) {
                        if (isCorrect) {
                            quizResults[existingResultIndex].correct++;
                        } else {
                            quizResults[existingResultIndex].wrong++;
                        }
                    } else {
                        quizResults.push({
                            date: currentDate,
                            correct: isCorrect ? 1 : 0,
                            wrong: isCorrect ? 0 : 1
                        });
                    }
                };

                correctButton.onclick = function () {
                    handleAnswer(true, this);
                };

                wrongButton.onclick = function () {
                    handleAnswer(false, this);
                };

                wordRow.appendChild(wordMeaning);
                const buttonGroup = document.createElement('div');
                buttonGroup.classList.add('flex', 'flex-wrap', 'items-center', 'gap-6', 'min-w-[300px]');
                buttonGroup.appendChild(showButton);
                buttonGroup.appendChild(correctButton);
                buttonGroup.appendChild(wrongButton);
                wordRow.appendChild(buttonGroup);
                quizWordsDiv.appendChild(wordRow);
            });
        }

        function upgradeLevel(index) {
            const word = words[index];
            switch (word.level) {
                case LEVELS.RED:
                    word.level = LEVELS.YELLOW;
                    break;
                case LEVELS.YELLOW:
                    word.level = LEVELS.GREEN_TESTED;
                    break;
                case LEVELS.GREEN_NEW:
                case LEVELS.GREEN_TESTED:
                    word.level = LEVELS.BLUE;
                    break;
            }
            word.consecutiveCorrect = 0;
        }

        function downgradeLevel(index) {
            const word = words[index];
            switch (word.level) {
                case LEVELS.BLUE:
                    word.level = LEVELS.GREEN_TESTED;
                    break;
                case LEVELS.GREEN_NEW:
                case LEVELS.GREEN_TESTED:
                    word.level = LEVELS.YELLOW;
                    break;
                case LEVELS.YELLOW:
                    word.level = LEVELS.RED;
                    break;
            }
        }

        function exportToExcel() {
            const table = document.querySelector('#statistics table');
            const wb = XLSX.utils.table_to_book(table);
            const ws = wb.Sheets[wb.SheetNames[0]];

            // å¤„ç†è¾“å…¥æ¡†çš„å€¼
            const rows = table.querySelectorAll('tbody tr');
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('td');
                cells.forEach((cell, colIndex) => {
                    const input = cell.querySelector('input');
                    if (input) {
                        const cellAddress = XLSX.utils.encode_cell({ r: rowIndex + 1, c: colIndex });
                        const value = parseInt(input.value);
                        if (!isNaN(value)) {
                            ws[cellAddress].v = value;
                            ws[cellAddress].t = 'n'; // è®¾ç½®å•å…ƒæ ¼ç±»å‹ä¸ºæ•°å­—
                        }
                    }
                });
            });

            // è‡ªåŠ¨è°ƒæ•´åˆ—å®½
            const range = XLSX.utils.decode_range(ws['!ref']);
            const colWidths = [];
            for (let C = range.s.c; C <= range.e.c; ++C) {
                let maxWidth = 0;
                for (let R = range.s.r; R <= range.e.r; ++R) {
                    const cell = ws[XLSX.utils.encode_cell({ r: R, c: C })];
                    if (cell && cell.v) {
                        const cellWidth = ('' + cell.v).length;
                        if (cellWidth > maxWidth) {
                            maxWidth = cellWidth;
                        }
                    }
                }
                colWidths[C] = { wch: maxWidth + 2 }; // å¢åŠ ä¸€äº›é¢å¤–çš„å®½åº¦
            }
            ws['!cols'] = colWidths;

            const wbout = XLSX.write(wb, { bookType: 'xlsx', bookSST: true, type: 'binary' });
            function s2ab(s) {
                const buf = new ArrayBuffer(s.length);
                const view = new Uint8Array(buf);
                for (let i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
                return buf;
            }
            const blob = new Blob([s2ab(wbout)], { type: 'application/octet-stream' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'english_word_statistics.xlsx';
            a.click();
            URL.revokeObjectURL(url);
        }

        function clearData() {
            const confirmClear = confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰è‹±è¯­æ•°æ®å—ï¼Ÿ');
            if (confirmClear) {
                words = [];
                statistics = {};
                quizResults = [];
                updateStatistics();
                saveData();
                console.log('è‹±è¯­æ•°æ®å·²æ¸…ç©º');
            }
        }

        function applySelection() {
            const checkboxes = document.querySelectorAll('#selection-list input[type="checkbox"]');
            const selectedWords = [];
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    const selectedWord = JSON.parse(checkbox.dataset.word);
                    if (selectedWord) {
                        selectedWords.push(selectedWord);
                    }
                }
            });
            showQuizWords(selectedWords);
            const selectionList = document.getElementById('selection-list');
            selectionList.style.display = 'none';
        }

        // ä¿®æ”¹é¡µé¢åŠ è½½é€»è¾‘
        window.onload = async function () {
            showLoading();
            await syncCloudData();
            updateStatistics();
            hideLoading();
        };

        function showLoading() {
            document.getElementById('loading').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }
    </script>
    <style>
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #888;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background-color: #555;
        }

        ::-webkit-scrollbar-track {
            background-color: #f1f1f1;
            border-radius: 4px;
        }

        /* è¡¨æ ¼æ ·å¼ */
        table {
            border-collapse: collapse;
            width: 100%;
            white-space: nowrap;
        }

        th,
        td {
            padding: 4px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            font-size: 0.8rem;
            line-height: 1.2;
        }

        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        input[type="number"] {
            width: 100%;
            padding: 4px;
            box-sizing: border-box;
            font-size: 0.8rem;
            line-height: 1.2;
        }

        /* è¡¨æ ¼å®¹å™¨æ ·å¼ï¼Œä½¿å…¶è‡ªé€‚åº”çˆ¶å®¹å™¨å¹¶å¯æ»šåŠ¨ */
       .table-container {
            width: 100%;
            max-height: 300px;
            overflow: auto;
        }

        /* å¯¼èˆªæ åœ¨å°å±å¹•ä¸‹å˜ä¸ºå‚ç›´æ’åˆ— */
        @media (max-width: 768px) {
            nav {
                flex-direction: column;
            }
            nav a {
                text-align: center;
            }
        }

        /* å•è¯æµ‹éªŒæŒ‰é’®åœ¨å°å±å¹•ä¸‹æ¢è¡Œ */
        #quiz .flex {
            flex-wrap: wrap;
        }
        #quiz .flex button {
            margin-bottom: 1rem;
        }
    </style>
</head>

<body class="font-sans bg-gray-100 text-gray-800">
    <!-- æ·»åŠ åŠ è½½æç¤º -->
    <div id="loading" class="fixed top-0 left-0 w-full h-full bg-white flex items-center justify-center z-50">
        <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"></div>
    </div>
    <!-- å¤´éƒ¨å¯¼èˆª -->
    <header class="bg-blue-600 text-white text-center py-6 shadow-md mb-8 sticky top-0 z-20">
        <h1 class="text-4xl font-bold">å…œå…œè‹±è¯­èƒŒå•è¯</h1>
    </header>
    <!-- å¯¼èˆªæ  -->
    <nav class="bg-blue-800 text-white flex justify-center mb-8 shadow-md">
        <a href="#import" class="py-3 px-6 hover:bg-blue-900 transition-colors">è¯åº“å¯¼å…¥</a>
        <a href="#statistics" class="py-3 px-6 hover:bg-blue-900 transition-colors">å­¦ä¹ ç»Ÿè®¡</a>
        <a href="#quiz" class="py-3 px-6 hover:bg-blue-900 transition-colors">å•è¯æµ‹éªŒ</a>
    </nav>
    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <main class="flex flex-col items-center px-4 md:px-16 lg:px-32 space-y-8">
        <!-- è¯åº“å¯¼å…¥éƒ¨åˆ† -->
        <div id="import" class="bg-white p-8 rounded-lg shadow-md w-full">
            <h2 class="text-3xl font-bold mb-6">è¯åº“å¯¼å…¥</h2>
            <textarea id="word-input" placeholder="è¯·è¾“å…¥è‹±æ–‡å•è¯-ä¸­æ–‡é‡Šä¹‰ï¼Œæ¯è¡Œä¸€ä¸ª"
                class="w-full h-32 mb-4 p-3 border border-gray-300 rounded-md resize-y text-lg focus:ring-blue-500 focus:border-blue-500"></textarea>
            <button onclick="importWords()"
                class="bg-blue-600 text-white py-3 px-6 rounded-md hover:bg-blue-700 transition-colors text-lg shadow-md">
                <i class="fa-solid fa-upload"></i> å¯¼å…¥è¯åº“
            </button>
        </div>
        <!-- å­¦ä¹ ç»Ÿè®¡éƒ¨åˆ† -->
        <div id="statistics" class="bg-white p-8 rounded-lg shadow-md w-full">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold">å­¦ä¹ ç»Ÿè®¡</h2>
                <div class="flex space-x-4">
                    <button onclick="exportToExcel()"
                        class="bg-blue-600 text-white py-3 px-6 rounded-md hover:bg-blue-700 transition-colors text-lg shadow-md">
                        <i class="fa-solid fa-file-excel"></i> å¯¼å‡ºåˆ° Excel
                    </button>
                    <button onclick="clearData()"
                        class="bg-red-600 text-white py-3 px-6 rounded-md hover:bg-red-700 transition-colors text-lg shadow-md">
                        <i class="fa-solid fa-trash"></i> æ¸…ç©ºæ•°æ®
                    </button>
                </div>
            </div>
            <div class="table-container overflow-x-auto mb-8 shadow-lg"> <!-- ä½¿ç”¨è¡¨æ ¼å®¹å™¨ -->
                <table class="min-w-max">
                    <thead class="sticky top-0 bg-white">
                        <tr>
                            <th class="py-3 px-4 bg-gray-200 text-left font-bold border-b">è‹±æ–‡å•è¯</th>
                            <th class="py-3 px-4 bg-gray-200 text-left font-bold border-b">ä¸­æ–‡é‡Šä¹‰</th>
                            <th class="py-3 px-4 bg-gray-200 text-left font-bold border-b">é»˜å†™æ¬¡æ•°</th>
                            <th class="py-3 px-4 bg-gray-200 text-left font-bold border-b">æ­£ç¡®æ¬¡æ•°</th>
                            <th class="py-3 px-4 bg-gray-200 text-left font-bold border-b">é”™è¯¯æ¬¡æ•°</th>
                            <th class="py-3 px-4 bg-gray-200 text-left font-bold border-b">é”™è¯¯ç‡</th>
                            <th class="py-3 px-4 bg-gray-200 text-left font-bold border-b">è®°å¿†å±‚çº§</th>
                            <th class="py-3 px-4 bg-gray-200 text-left font-bold border-b">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="statistics-table-body">
                    </tbody>
                </table>
            </div>
        </div>
        <!-- å•è¯æµ‹éªŒéƒ¨åˆ† -->
        <div id="quiz" class="bg-white p-8 rounded-lg shadow-md w-full">
            <h2 class="text-3xl font-bold mb-6">å•è¯æµ‹éªŒ</h2>
            <div class="flex space-x-4 mb-6">
                <button onclick="randomQuiz()"
                    class="bg-blue-600 text-white py-3 px-6 rounded-md hover:bg-blue-700 transition-colors text-lg shadow-md">
                    <i class="fa-solid fa-dice"></i> æ™ºèƒ½æŠ½é¢˜
                </button>
                <button onclick="showSelectionList()"
                    class="bg-blue-600 text-white py-3 px-6 rounded-md hover:bg-blue-700 transition-colors text-lg shadow-md">
                    <i class="fa-solid fa-list-check"></i> è‡ªä¸»é€‰é¢˜
                </button>
            </div>
            <input type="text" id="filter-input" placeholder="è¾“å…¥å…³é”®è¯ç­›é€‰å•è¯"
                class="hidden w-full mb-4 p-3 border border-gray-300 rounded-md text-lg focus:ring-blue-500 focus:border-blue-500">
            <div id="quiz-words"></div>
            <div id="selection-list" class="hidden relative w-full max-h-96 overflow-y-auto">
                <div class="sticky top-0 bg-white z-10 flex justify-between items-center p-4 border-b">
                    <h2 class="text-xl font-bold">è‡ªä¸»é€‰é¢˜åˆ—è¡¨</h2>
                    <div class="flex space-x-4">
                        <input type="text" id="selection-search" placeholder="æ¨¡ç³Šæœç´¢å•è¯"
                            class="p-2 border border-gray-300 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500">
                        <button onclick="applySelection()"
                            class="bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors text-sm shadow-md">åº”ç”¨é€‰æ‹©</button>
                    </div>
                </div>
                <table class="w-full">
                    <thead>
                        <tr>
                            <th>é€‰æ‹©</th>
                            <th>è‹±æ–‡å•è¯</th>
                            <th>ä¸­æ–‡é‡Šä¹‰</th>
                            <th>é»˜å†™æ¬¡æ•°</th>
                            <th>é”™è¯¯ç‡</th>
                            <th>è®°å¿†å±‚çº§</th>
                        </tr>
                    </thead>
                    <tbody id="selection-list-table-body">
                    </tbody>
                </table>
            </div>
        </div>
    </main>
</body>

</html>    